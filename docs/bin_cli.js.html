<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: bin/cli.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: bin/cli.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>#!/usr/bin/env node
'use strict';
/**
 * JSON-TO-SCSS Command Line Interface.
 * @author Renaud LapoÃ«le
 */


/**
 * Module dependencies.
 */
const path                       = require('path');
const packageJson                = require(path.join(__dirname, '../package.json'));
const args                       = require('yargs').argv;
const chalk                      = require('chalk');
const glob                       = require('glob');
const pathBasename               = require('../lib/utils/path/basename');
const removePathExtension        = require('../lib/utils/path/removeExtension');
const jsJsonFilesToSassScssFiles = require('../lib/jsJsonFilesToSassScssFiles');


/**
 * @function banner
 * @param {string} name - the name of the package the banner is getting built for.
 * @param {string} version - the version number of the package the banner is getting built for.
 * @returns {string} this lib/package's name &amp; version.
 * @description Returns a string containing the name and the version of this lib/package.
 */
function banner(name, version) {
  return `${chalk.bold(`${name || 'NO NAME'} v${version || '0.0.0'}`)}`;
}


/**
 * @function usage
 * @param {string} name - the name of the package usage instructions are generated for.
 * @returns {string} the lib/package's usage text.
 * @description Returns the usage description of this lib/package.
 */
function usage(name) {
  return `
    ${chalk.bold('Usage')}: ${chalk.yellow(name || 'NO NAME')} &lt;source> [destination] [options]
    
           ${chalk.bold('source')}:           the path to a javascript, json or group of files to be converted.
           (required)        - only '.js' and '.json' are processed.
           
           ${chalk.bold('destination')}:      the full or partial destination of the converted files.
           (optional)        - when the destination is a directory path only, all generated
                               files are saved in it with a default '.scss' extension. If
                               a '.sass' extension is required instead, the --sass option must be included.
    
                       
           ${chalk.bold('options')}:
           
            --h              (help)           Show this message.
            --p='prefix'     (prefix)         Prepend the converted sass/scss content with the prefix.
                                              Prefix is usually used &amp; set to be used as sass variable name.
                                              Default '\${source-filename} :'.
            --no-underscore  (no leading _)   Remove any leading '_' (underscore) characters from the
                                              prefix when used as sass variable name.
            --s='suffix'     (suffix)         Append the converted sass/scss content with the suffix.
                                              Default: ';' (default not used if --sass)
            --tt='tabText'   (tab text)       Text to be used to indent or tabulate sass map.
                                              Default: '  ' (two space characters)
            --tn=tabNumber   (tab number)     Number of tabulations.
                                              Default: 1 (set to 0 if --sass)
            --es='sq'||'dq'  (empty string)   Sass/scss representation for an empty string.
                                              Default is '""': { "prop": "" } => $xyzfilename: ( prop: "" );
            --sass           (sass ext.)      Use sass extension.

                                          
`;
}


/**
 * @function hasArgs
 * @param {object} args - command line arguments extracted via/from/with yargs.
 * @returns {boolean} true if args has an "_" property and if this property has a length property which is different than 0.
 * @description This is an internal small helper function to quickly assess if 'json-to-scss' is called without any params. Note that the code written here relies on the fact that we are using the 'yargs' package.
 */
function hasArgs(args) {
  return args._ &amp;&amp; args._.length;
}


/**
 * @function extensionCorrector
 * @param {string} defaultExtension - the destination file extension to be used by default.
 * @param {string} requiredExtension - the destination file extension which must be used.
 * @returns {Function} a function to be used as input for an Array.map(fn) function call.
 * @description Internal helper function encapsulating the destination file extension transformations.
 */
function extensionCorrector(defaultExtension, requiredExtension) {
  return (filepath) => {
    const _extname = path.extname(filepath).toLowerCase();
    switch(_extname) {
    case '': return `${filepath}${'' !== requiredExtension ? requiredExtension : defaultExtension}`;
    case '.scss': return (('' === requiredExtension) || (requiredExtension === _extname)) ? filepath : `${removePathExtension(filepath, { mustValidateInput: false, recurse: false})}${requiredExtension}`;
    case '.sass': return (('' === requiredExtension) || (requiredExtension === _extname)) ? filepath : `${removePathExtension(filepath, { mustValidateInput: false, recurse: false})}${requiredExtension}`;
    default : return `${removePathExtension(filepath, { mustValidateInput: false, recurse: false})}${'' !== requiredExtension ? requiredExtension : defaultExtension}`;
    }
  };
}


/**
 * @function basenameExtractor
 * @param {string} filepath - the file path from which we want to extract the basename.
 * @returns {string} the file path basename.
 * @description Internal helper &amp; wrapper function extracting the file path's base name.
 */
function basenameExtractor(filepath) {
  return pathBasename(filepath);
}


/**
 * @function dirnameSetup
 * @param {string} dirname - the directory name we want to use for our destination file paths.
 * @returns {function} a function to be used as input for an Array.map(fn) function call.
 * @description set the directory(ies) for the given destination file path.
 */
function dirnameSetup(dirname) {
  return (filepath) => path.resolve(path.join(dirname,filepath));
}


/**
 * @function normalizeArgs
 * @param {object} args - command line program arguments (built by the yargs package) to be normalized.
 * @returns {{source: {paths: *}, destination: {paths: (*|Array)}, options: {prefix: string | string, suffix: (*|string), emptyString: string, indentationText: (*|string), indentationSize: (*|number), noUnderscore: boolean, format: string}}}
 * @description check &amp; normalize the command line program arguments.
 */
function normalizeArgs(args) {
  const _source = path.resolve(process.cwd(), `${args._[0]}`);
  const _sourcePaths = glob.sync(_source);
  const _defaultExtension = '.scss';
  const _requiredExtension = args.sass ? '.sass' : '';
  
  let _destination = args._.length > 1 ? removePathExtension(path.resolve(process.cwd(), args._[1])) : '';
  let _destinationPaths = [];
  if('' === _destination) {
    _destinationPaths = _sourcePaths.map(extensionCorrector(_defaultExtension, _requiredExtension));
  }
  else {
    _destinationPaths =
      _sourcePaths
        .map(basenameExtractor)
        .map(extensionCorrector(_defaultExtension, _requiredExtension))
        .map(dirnameSetup(_destination));
  }
  
  
  return {
    source: {
      paths: _sourcePaths
    },
    destination: {
      paths: _destinationPaths,
    },
    options: {
      prefix: args.p || '',
      suffix: args.s || ';',
      emptyString: args.es &amp;&amp; ('sq' === args.es)? "''" : '""',
      indentationText: args.tt || '  ',
      indentationSize: args.tn || 1,
      noUnderscore: args.underscore === false,
      format: args.sass ? '.sass': '.scss'
    }
  };
}


/**
 * The 'json-to-scss' main function in charge of parsing arguments and, if possible,
 * executing the file conversion.
 */
function main() {
  console.log(banner(packageJson.name, packageJson.version));
  if (hasArgs(args)) {
    
    if (args.h || args.help) {
      console.log(usage(packageJson.name));
    }
    else {
      const _nargs = normalizeArgs(args);
      jsJsonFilesToSassScssFiles(_nargs.source.paths, _nargs.destination.paths, _nargs.options);
    }
  }
  else {
    console.log(usage(packageJson.name));
  }
}


/**
 * Execute the main module function.
 */
main();

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-json-to-scss_lib_converter_jsToSassString.html">json-to-scss/lib/converter/jsToSassString</a></li><li><a href="module-json-to-scss_lib_jsJsonFilesToSassScssFiles_.html">json-to-scss/lib/jsJsonFilesToSassScssFiles</a></li><li><a href="module-lib_utils_inspection_isNull.html">lib/utils/inspection/isNull</a></li><li><a href="module-lib_utils_inspection_isPositiveInteger.html">lib/utils/inspection/isPositiveInteger</a></li><li><a href="module-lib_utils_inspection_isString.html">lib/utils/inspection/isString</a></li><li><a href="module-lib_utils_inspection_isUndefined.html">lib/utils/inspection/isUndefined</a></li><li><a href="module-lib_utils_path_basename.html">lib/utils/path/basename</a></li><li><a href="module-lib_utils_path_hasExtension.html">lib/utils/path/hasExtension</a></li><li><a href="module-lib_utils_path_removeExtension.html">lib/utils/path/removeExtension</a></li><li><a href="module-lib_utils_textIndentation.html">lib/utils/textIndentation</a></li></ul><h3>Global</h3><ul><li><a href="global.html#banner">banner</a></li><li><a href="global.html#basenameExtractor">basenameExtractor</a></li><li><a href="global.html#createPathDirectories">createPathDirectories</a></li><li><a href="global.html#dirnameSetup">dirnameSetup</a></li><li><a href="global.html#extensionCorrector">extensionCorrector</a></li><li><a href="global.html#hasArgs">hasArgs</a></li><li><a href="global.html#main">main</a></li><li><a href="global.html#normalizeArgs">normalizeArgs</a></li><li><a href="global.html#path">path</a></li><li><a href="global.html#usage">usage</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Aug 28 2018 00:13:42 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
